syslog-ng-jdbc
==============

This is a JDBC destination for syslog-ng.

Schema
-----

```sql
CREATE TABLE RSYSLOG.MESSAGES (
	ID		BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1, NO CACHE),
	TIME		TIMESTAMP NOT NULL,
	HOST		VARCHAR(128) NOT NULL,
	SOURCE		VARCHAR(128) NOT NULL,
	PRIORITY	INTEGER NOT NULL,
	LEVEL		VARCHAR(16) NOT NULL,
	FACILITY_NUM	INTEGER NOT NULL,
	FACILITY	VARCHAR(16) NOT NULL,
	PROGRAM		VARCHAR(64),
	PID		BIGINT,
	MESSAGE		CLOB(64k) NOT NULL,
	PRIMARY KEY (ID)
) IN TSSYSLOG;
```

Configuration
-------------

```
@module mod-java
destination d_java {
	java(
		class_path("/opt/syslog-ng-jdbc/db2jcc4.jar:/opt/syslog-ng-jdbc/db2jcc_license_cu.jar:/opt/syslog-ng-jdbc/syslog_ng_jdbc.jar")
		class_name("com.everyware.syslog_ng.JdbcDestination")
		template("${ISODATE} ${PRI:-00} ${LEVEL} ${FULLHOST_FROM:-unknown} ${HOST:-unknown} ${FACILITY_NUM:-0} ${FACILITY:-unknown} ${PROGRAM:-unknown} ${PID:-0} ${MSGONLY}")
		option("driver", "com.ibm.db2.jcc.DB2Driver")
		option("url", "jdbc:db2://db2node01.db2.lan:50000/rsyslog:currentSchema=RSYSLOG;")
		option("username", "rsyslog")
		option("password", "top-secret")
	);
};
log { source(s_remote); destination(d_java); };
```

How to build
------------

- Install [mx](https://github.com/graalvm/mx)
- Build: `mx build`
- Run unit tests: `mx unittest`
